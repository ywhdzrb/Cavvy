// 高级类型转换测试
// 测试i32与double之间的类型提升和显式转换

public class TypeCastingAdvancedTest {
    public static void main(string[] args) {
        println("=== Advanced Type Casting Tests ===");

        // 测试1: i32 + double 混合运算（类型提升）
        println("\nTest 1: i32 + double promotion");
        int intVal = 10;
        double doubleVal = 3.5;
        double result1 = intVal + doubleVal;  // i32应该提升为double
        print("int (10) + double (3.5) = ");
        println(result1);
        // 验证结果
        if (result1 == 13.5) {
            println("PASS: i32 + double promotion works!");
        } else {
            println("FAIL: Expected 13.5");
        }

        // 测试2: double + i32 混合运算
        println("\nTest 2: double + i32 promotion");
        double result2 = doubleVal + intVal;
        print("double (3.5) + int (10) = ");
        println(result2);
        if (result2 == 13.5) {
            println("PASS: double + i32 promotion works!");
        } else {
            println("FAIL: Expected 13.5");
        }

        // 测试3: i32 * double 混合运算
        println("\nTest 3: i32 * double promotion");
        int a = 5;
        double b = 2.5;
        double result3 = a * b;
        print("int (5) * double (2.5) = ");
        println(result3);
        if (result3 == 12.5) {
            println("PASS: i32 * double promotion works!");
        } else {
            println("FAIL: Expected 12.5");
        }

        // 测试4: double / i32 混合运算
        println("\nTest 4: double / i32 promotion");
        double c = 15.0;
        int d = 4;
        double result4 = c / d;
        print("double (15.0) / int (4) = ");
        println(result4);
        if (result4 == 3.75) {
            println("PASS: double / i32 promotion works!");
        } else {
            println("FAIL: Expected 3.75");
        }

        // 测试5: 显式转换 double 到 i32
        println("\nTest 5: Explicit cast double to i32");
        double e = 7.9;
        int intResult = (int)e;  // 应该截断为7
        print("(int)7.9 = ");
        println(intResult);
        if (intResult == 7) {
            println("PASS: double to i32 cast works!");
        } else {
            println("FAIL: Expected 7");
        }

        // 测试6: 显式转换 i32 到 double
        println("\nTest 6: Explicit cast i32 to double");
        int f = 42;
        double doubleResult = (double)f;
        print("(double)42 = ");
        println(doubleResult);
        if (doubleResult == 42.0) {
            println("PASS: i32 to double cast works!");
        } else {
            println("FAIL: Expected 42.0");
        }

        // 测试7: 显式转换 float 到 i32
        println("\nTest 7: Explicit cast float to i32");
        float g = 5.7f;
        int intFromFloat = (int)g;
        print("(int)5.7f = ");
        println(intFromFloat);
        if (intFromFloat == 5) {
            println("PASS: float to i32 cast works!");
        } else {
            println("FAIL: Expected 5");
        }

        // 测试8: 显式转换 i32 到 float
        println("\nTest 8: Explicit cast i32 to float");
        int h = 100;
        float floatResult = (float)h;
        print("(float)100 = ");
        println(floatResult);
        // float结果应该接近100
        println("PASS: i32 to float cast works!");

        // 测试9: 显式转换 long 到 i32（截断）
        println("\nTest 9: Explicit cast long to i32");
        long bigNum = 2147483647L;  // i32最大值
        int intFromLong = (int)bigNum;
        print("(int)2147483647L = ");
        println(intFromLong);
        if (intFromLong == 2147483647) {
            println("PASS: long to i32 cast works!");
        } else {
            println("FAIL: Expected 2147483647");
        }

        // 测试10: 显式转换 i32 到 long
        println("\nTest 10: Explicit cast i32 to long");
        int smallNum = 12345;
        long longResult = (long)smallNum;
        print("(long)12345 = ");
        println(longResult);
        if (longResult == 12345L) {
            println("PASS: i32 to long cast works!");
        } else {
            println("FAIL: Expected 12345");
        }

        // 测试11: 显式转换 double 到 float
        println("\nTest 11: Explicit cast double to float");
        double precise = 3.14159265359;
        float floatFromDouble = (float)precise;
        print("(float)3.14159265359 = ");
        println(floatFromDouble);
        println("PASS: double to float cast works!");

        // 测试12: 显式转换 float 到 double
        println("\nTest 12: Explicit cast float to double");
        float approx = 2.5f;
        double doubleFromFloat = (double)approx;
        print("(double)2.5f = ");
        println(doubleFromFloat);
        if (doubleFromFloat == 2.5) {
            println("PASS: float to double cast works!");
        } else {
            println("FAIL: Expected 2.5");
        }

        // 测试13: 复杂表达式中的类型转换
        println("\nTest 13: Complex expression with type casting");
        int x = 10;
        int y = 3;
        double divResult = (double)x / (double)y;  // 应该得到3.333...
        print("(double)10 / (double)3 = ");
        println(divResult);
        if (divResult > 3.3 && divResult < 3.4) {
            println("PASS: Complex cast expression works!");
        } else {
            println("FAIL: Expected around 3.333");
        }

        // 测试14: 比较运算中的类型提升
        println("\nTest 14: Comparison with type promotion");
        int m = 5;
        double n = 5.0;
        boolean isEqual = (m == n);  // i32应该提升为double进行比较
        print("5 == 5.0: ");
        println(isEqual);
        if (isEqual) {
            println("PASS: Comparison with promotion works!");
        } else {
            println("FAIL: Expected true");
        }

        // 测试15: 负数转换
        println("\nTest 15: Negative number casting");
        int negInt = -42;
        double negDouble = (double)negInt;
        print("(double)(-42) = ");
        println(negDouble);
        if (negDouble == -42.0) {
            println("PASS: Negative number cast works!");
        } else {
            println("FAIL: Expected -42.0");
        }

        println("\n=== All advanced type casting tests completed! ===");
    }
}
